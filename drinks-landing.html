<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Drinks – Premium Cocktail</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #05050d;
      font-family: 'DM Sans', sans-serif;
      overflow: hidden;
    }

    :root {
      --gold:   #c9a84c;
      --cream:  #f0e6c8;
      --teal:   #00c4b8;
      --purple: #6c3fa0;
    }

    /* ── Page ── */
    #drinks-page {
      width: 100vw;
      height: 100vh;
      background:
        radial-gradient(ellipse at 18% 12%, #12082e 0%, transparent 50%),
        radial-gradient(ellipse at 88% 90%, #0a1a1a 0%, transparent 45%),
        #05050d;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 2rem;
      padding: 4rem 7vw;
      position: relative;
      overflow: hidden;
    }

    /* Grain overlay */
    #drinks-page::after {
      content: '';
      position: fixed; inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.045'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 20;
      opacity: .4;
    }

    /* ── Background glows ── */
    .bg-glow {
      position: absolute;
      border-radius: 50%;
      filter: blur(100px);
      pointer-events: none;
      animation: gp 10s ease-in-out infinite alternate;
    }
    .bg-glow-1 { width:500px; height:500px; background:#4a1880; opacity:.09; top:-140px; left:-100px; }
    .bg-glow-2 { width:350px; height:350px; background:#006655; opacity:.10; bottom:-80px; right:4%; animation-duration:7s; animation-delay:1s; animation-direction:alternate-reverse; }
    .bg-glow-3 { width:200px; height:200px; background:#c9a84c; opacity:.06; top:40%; left:40%; animation-duration:12s; animation-delay:2s; }
    @keyframes gp { to { transform: scale(1.4); } }

    /* ── Corner accents ── */
    .corner { position: absolute; width: 52px; height: 52px; opacity: .2; z-index: 2; }
    .corner-tl { top:1.8rem; left:1.8rem; border-top:1px solid var(--teal); border-left:1px solid var(--teal); }
    .corner-br { bottom:1.8rem; right:1.8rem; border-bottom:1px solid var(--gold); border-right:1px solid var(--gold); }

    /* ── Hero text ── */
    .hero {
      display: flex;
      flex-direction: column;
      gap: 1.6rem;
      position: relative;
      z-index: 3;
      max-width: 460px;
    }
    .eyebrow {
      font-size: .7rem; letter-spacing: .5em; text-transform: uppercase;
      color: var(--teal);
      opacity: 0; animation: fadeUp .8s ease forwards .3s;
    }
    .hero-title {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(4.5rem, 12vw, 10rem);
      line-height: .86;
      opacity: 0; animation: fadeUp .8s ease forwards .55s;
    }
    .title-ghost {
      display: block;
      -webkit-text-stroke: 1.5px rgba(201,168,76,.2);
      color: transparent;
    }
    .title-solid { display: block; color: var(--cream); }
    .tagline {
      font-size: .85rem; font-style: italic; font-weight: 300;
      color: var(--gold); letter-spacing: .08em;
      opacity: 0; animation: fadeUp .8s ease forwards .75s;
    }
    .subtitle {
      font-size: .95rem; color: rgba(240,230,200,.35);
      font-weight: 300; line-height: 1.9; max-width: 290px;
      opacity: 0; animation: fadeUp .8s ease forwards .95s;
    }
    .cta-row {
      display: flex; gap: 1rem; align-items: center;
      opacity: 0; animation: fadeUp .8s ease forwards 1.2s;
    }
    .btn-primary {
      background: linear-gradient(135deg, #c9a84c, #f0e6c8, #c9a84c);
      background-size: 200% 100%;
      color: #05050d; border: none; padding: .88rem 2.5rem;
      font-family: 'DM Sans', sans-serif; font-size: .8rem;
      font-weight: 700; letter-spacing: .15em; text-transform: uppercase;
      cursor: pointer; transition: background-position .4s, transform .2s, box-shadow .2s;
      clip-path: polygon(10px 0%, 100% 0%, calc(100% - 10px) 100%, 0% 100%);
    }
    .btn-primary:hover {
      background-position: 100%;
      transform: translateY(-2px);
      box-shadow: 0 14px 40px rgba(201,168,76,.4);
    }
    .btn-secondary {
      background: transparent; color: rgba(240,230,200,.4);
      border: 1px solid rgba(201,168,76,.2); padding: .88rem 2rem;
      font-family: 'DM Sans', sans-serif; font-size: .8rem;
      letter-spacing: .15em; text-transform: uppercase; cursor: pointer;
      transition: color .2s, border-color .2s;
    }
    .btn-secondary:hover { color: var(--cream); border-color: var(--gold); }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(26px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* ── Animation canvas ── */
    #can-canvas {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 4;
      overflow: hidden;
    }

    /* ── Trail dot ── */
    .trail-dot {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
      transition: none;
    }

    /* ── Can wrapper ── */
    #can-wrapper {
      position: absolute;
      transform-origin: center center;
    }

    /* ── Drip ── */
    .drip {
      position: absolute;
      border-radius: 50% 50% 65% 65%;
      animation: dripFall .8s ease-in infinite;
    }
    @keyframes dripFall {
      0%   { transform: translateY(0) scaleX(1); opacity: 1; }
      100% { transform: translateY(38px) scaleX(.45); opacity: 0; }
    }

    /* ── All Gone label ── */
    #all-gone {
      position: absolute;
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(.9rem, 2.2vw, 1.4rem);
      letter-spacing: .45em;
      color: rgba(201,168,76,.9);
      white-space: nowrap;
      z-index: 5;
      opacity: 0;
      transform: translateX(-50%);
      transition: opacity 1s ease;
      pointer-events: none;
    }

    /* ── Bottom bar ── */
    #bottom-bar {
      position: absolute; bottom: 0; left: 0; right: 0; height: 2px;
      background: linear-gradient(90deg, transparent, var(--purple), var(--gold), var(--teal), transparent);
      animation: shimmer 3.5s ease-in-out infinite;
      z-index: 3;
    }
    @keyframes shimmer { 0%,100%{opacity:.3} 50%{opacity:.9} }

    /* ── Bubble animation ── */
    @keyframes bubbleRise {
      0%   { transform: translateY(0) scale(1); opacity: .8; }
      100% { transform: translateY(-80px) scale(.15); opacity: 0; }
    }
  </style>
</head>
<body>

<div id="drinks-page">
  <!-- Background glows -->
  <div class="bg-glow bg-glow-1"></div>
  <div class="bg-glow bg-glow-2"></div>
  <div class="bg-glow bg-glow-3"></div>

  <!-- Corner accents -->
  <div class="corner corner-tl"></div>
  <div class="corner corner-br"></div>

  <!-- Hero text -->
  <div class="hero">
    <p class="eyebrow">Crafted · 2024 · Reserve Collection</p>
    <h1 class="hero-title">
      <span class="title-ghost">CRAFT</span>
      <span class="title-solid">DRINKS</span>
    </h1>
    <p class="tagline">— Distilled for those who know —</p>
    <p class="subtitle">
      Premium RTD cocktails. No compromise on spirit, no compromise on taste.
    </p>
    <div class="cta-row">
      <button class="btn-primary">Shop Now</button>
      <button class="btn-secondary">Our Range →</button>
    </div>
  </div>

  <!-- Animation layer -->
  <div id="can-canvas">
    <!-- Trail dots injected by JS -->
    <!-- Can SVG injected by JS -->
    <div id="can-wrapper"></div>
    <!-- Drips injected by JS -->
    <div id="drips-container"></div>
    <!-- All gone -->
    <div id="all-gone">ALL GONE</div>
  </div>

  <div id="bottom-bar"></div>
</div>

<script>
(function () {
  "use strict";

  /* ─── Helpers ──────────────────────────────────────────── */
  const easeOutCubic  = t => 1 - Math.pow(1 - t, 3);
  const easeInOutQuad = t => t < .5 ? 2*t*t : 1 - Math.pow(-2*t+2, 2)/2;
  const lerp          = (a, b, t) => a + (b - a) * t;
  const clamp         = (v, lo, hi) => Math.max(lo, Math.min(hi, v));

  /* ─── Build SVG can ────────────────────────────────────── */
  function buildCanSVG(fillLevel) {
    const liquidStart = 26;
    const liquidEnd   = 154;
    const liquidH     = liquidEnd - liquidStart;
    const clipY       = liquidStart + liquidH * (1 - fillLevel);

    const bubbleData = [
      { cx: 32, dur: 2.1, delay: 0.0 },
      { cx: 44, dur: 1.8, delay: 0.6 },
      { cx: 58, dur: 2.4, delay: 1.1 },
      { cx: 68, dur: 1.6, delay: 1.7 },
      { cx: 38, dur: 2.0, delay: 2.2 },
      { cx: 62, dur: 1.9, delay: 0.3 },
    ];

    const showFoam    = fillLevel > 0.04;
    const showBubbles = fillLevel > 0.07;
    const showLiquid  = fillLevel > 0.02;

    const bubblesHTML = showBubbles ? bubbleData.map(b => `
      <circle cx="${b.cx}" cy="148" r="${1.5 + (bubbleData.indexOf(b) % 3) * 0.7}"
        fill="rgba(200,245,242,0.8)"
        clip-path="url(#cBodyClip)"
        style="animation:bubbleRise ${b.dur}s ease-in infinite; animation-delay:${b.delay}s"/>
    `).join('') : '';

    const foamHTML = showFoam ? `
      <ellipse cx="50" cy="${clipY + 5}" rx="33" ry="6" fill="rgba(255,255,255,0.7)"/>
      <ellipse cx="50" cy="${clipY + 3}" rx="24" ry="3.5" fill="rgba(255,255,255,0.5)"/>
    ` : '';

    return `
    <svg id="can-svg" viewBox="0 0 100 180" width="100%" height="100%"
      xmlns="http://www.w3.org/2000/svg" style="overflow:visible">
      <defs>
        <clipPath id="cBodyClip">
          <rect x="14" y="22" width="72" height="136" rx="6"/>
        </clipPath>
        <clipPath id="cFillClip">
          <rect x="14" y="${clipY}" width="72" height="${liquidEnd - clipY + 2}"/>
        </clipPath>
        <linearGradient id="darkMetal" x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%"   stop-color="#1a1a2e"/>
          <stop offset="12%"  stop-color="#2a2a42"/>
          <stop offset="30%"  stop-color="#1e1e38"/>
          <stop offset="50%"  stop-color="#22223a"/>
          <stop offset="70%"  stop-color="#1a1a2e"/>
          <stop offset="88%"  stop-color="#131325"/>
          <stop offset="100%" stop-color="#0e0e1e"/>
        </linearGradient>
        <linearGradient id="shineGrad" x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%"   stop-color="rgba(255,255,255,0)"/>
          <stop offset="40%"  stop-color="rgba(255,255,255,0.12)"/>
          <stop offset="100%" stop-color="rgba(255,255,255,0)"/>
        </linearGradient>
        <linearGradient id="goldFoil" x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%"   stop-color="#6b4f10"/>
          <stop offset="20%"  stop-color="#c9a84c"/>
          <stop offset="40%"  stop-color="#f0d878"/>
          <stop offset="60%"  stop-color="#c9a84c"/>
          <stop offset="80%"  stop-color="#a07828"/>
          <stop offset="100%" stop-color="#6b4f10"/>
        </linearGradient>
        <linearGradient id="tealBand" x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%"   stop-color="#005548"/>
          <stop offset="50%"  stop-color="#00c4b8"/>
          <stop offset="100%" stop-color="#005548"/>
        </linearGradient>
        <linearGradient id="spirit" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%"   stop-color="rgba(180,240,235,0.72)"/>
          <stop offset="50%"  stop-color="rgba(140,220,210,0.60)"/>
          <stop offset="100%" stop-color="rgba(80,180,170,0.55)"/>
        </linearGradient>
        <linearGradient id="lidMetal" x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%"   stop-color="#5a5a6a"/>
          <stop offset="45%"  stop-color="#aaaabc"/>
          <stop offset="100%" stop-color="#5a5a6a"/>
        </linearGradient>
        <filter id="canShadow" x="-25%" y="-10%" width="150%" height="130%">
          <feDropShadow dx="0" dy="10" stdDeviation="10" flood-color="#000" flood-opacity="0.7"/>
        </filter>
      </defs>

      <!-- Body -->
      <rect x="14" y="22" width="72" height="136" rx="6"
        fill="url(#darkMetal)" filter="url(#canShadow)"/>

      <!-- Liquid -->
      ${showLiquid ? `
      <g clip-path="url(#cFillClip)">
        <g clip-path="url(#cBodyClip)">
          <rect x="14" y="22" width="72" height="136" fill="url(#spirit)"/>
          <rect x="14" y="22" width="72" height="136" fill="rgba(255,255,255,0.06)"/>
          ${foamHTML}
        </g>
      </g>` : ''}

      <!-- Bubbles -->
      ${bubblesHTML}

      <!-- Label -->
      <g clip-path="url(#cBodyClip)">
        <rect x="14" y="50" width="72" height="88" fill="#0d0d22"/>
        <rect x="14" y="58" width="72" height="72" fill="#0a0a1c"/>
        <line x1="14" y1="58" x2="86" y2="130" stroke="rgba(201,168,76,0.08)" stroke-width="1"/>
        <line x1="30" y1="58" x2="86" y2="114" stroke="rgba(201,168,76,0.06)" stroke-width="1"/>
        <line x1="14" y1="74" x2="70" y2="130" stroke="rgba(201,168,76,0.06)" stroke-width="1"/>

        <rect x="14" y="50" width="72" height="6"  fill="url(#tealBand)" opacity="0.9"/>
        <rect x="14" y="56" width="72" height="4"  fill="url(#goldFoil)"/>

        <!-- Martini glass icon -->
        <polygon points="50,68 34,82 66,82" fill="none"
          stroke="rgba(201,168,76,0.7)" stroke-width="1.2"/>
        <line x1="50" y1="82" x2="50" y2="92"
          stroke="rgba(201,168,76,0.7)" stroke-width="1.2"/>
        <line x1="44" y1="92" x2="56" y2="92"
          stroke="rgba(201,168,76,0.7)" stroke-width="1.2"/>
        <circle cx="62" cy="74" r="2.5" fill="rgba(0,196,184,0.8)"/>
        <line x1="62" y1="68" x2="62" y2="80"
          stroke="rgba(201,168,76,0.5)" stroke-width="0.8"/>

        <text x="50" y="107" text-anchor="middle"
          font-family="'Bebas Neue', sans-serif" font-size="14"
          fill="#f0e6c8" letter-spacing="5">DRINKS</text>
        <text x="50" y="118" text-anchor="middle"
          font-family="'DM Sans', sans-serif" font-size="4.5"
          fill="rgba(201,168,76,0.75)" letter-spacing="3.5">PREMIUM COCKTAIL</text>

        <line x1="18" y1="122" x2="38" y2="122"
          stroke="rgba(201,168,76,0.3)" stroke-width="0.7"/>
        <line x1="62" y1="122" x2="82" y2="122"
          stroke="rgba(201,168,76,0.3)" stroke-width="0.7"/>

        <text x="50" y="128" text-anchor="middle"
          font-family="'DM Sans', sans-serif" font-size="3.8"
          fill="rgba(255,255,255,0.25)" letter-spacing="1.5">5% ALC/VOL · 250ml</text>

        <rect x="14" y="128" width="72" height="4" fill="url(#goldFoil)"/>
        <rect x="14" y="132" width="72" height="6" fill="url(#tealBand)" opacity="0.9"/>
        <rect x="18"  y="50"  width="10" height="88" fill="url(#shineGrad)"/>
      </g>

      <!-- Top taper + lid -->
      <path d="M14,22 Q14,8 26,5 L74,5 Q86,8 86,22 Z" fill="url(#darkMetal)"/>
      <ellipse cx="50" cy="5" rx="24" ry="6" fill="url(#lidMetal)"/>
      <ellipse cx="50" cy="5" rx="18" ry="4" fill="#8a8a9a"/>
      <ellipse cx="50" cy="5" rx="12" ry="2.5" fill="#aaaabc"/>
      <rect x="44" y="-2" width="12" height="5" rx="2" fill="url(#goldFoil)"/>
      <ellipse cx="50" cy="-2" rx="5" ry="3" fill="none"
        stroke="url(#goldFoil)" stroke-width="1.5"/>
      <circle cx="50" cy="3" r="1.5" fill="#888"/>

      <!-- Bottom -->
      <path d="M14,158 Q14,172 26,175 L74,175 Q86,172 86,158 Z" fill="url(#darkMetal)"/>
      <ellipse cx="50" cy="175" rx="24" ry="5" fill="#3a3a4a"/>
      <ellipse cx="50" cy="175" rx="16" ry="3" fill="#2a2a38"/>

      <!-- Ridges -->
      <rect x="14" y="22"    width="72" height="1.5" fill="rgba(255,255,255,0.12)"/>
      <rect x="14" y="155.5" width="72" height="1.5" fill="rgba(0,0,0,0.35)"/>
    </svg>`;
  }

  /* ─── State ─────────────────────────────────────────────── */
  const CAN_W = 160;
  const CAN_H = 256;

  const canWrapper   = document.getElementById('can-wrapper');
  const dripsEl      = document.getElementById('drips-container');
  const allGoneEl    = document.getElementById('all-gone');
  const canvas       = document.getElementById('can-canvas');

  // inject initial can SVG
  canWrapper.style.width  = CAN_W + 'px';
  canWrapper.style.height = CAN_H + 'px';
  canWrapper.style.position = 'absolute';
  canWrapper.innerHTML = buildCanSVG(1);

  // trail dots pool
  const TRAIL_COUNT = 12;
  const trailDots = [];
  for (let i = 0; i < TRAIL_COUNT; i++) {
    const d = document.createElement('div');
    d.className = 'trail-dot';
    d.style.display = 'none';
    canvas.insertBefore(d, canWrapper);
    trailDots.push(d);
  }

  let trailHistory = [];

  // drips
  const DRIP_COUNT = 3;
  const drips = [];
  for (let i = 0; i < DRIP_COUNT; i++) {
    const d = document.createElement('div');
    d.className = 'drip';
    d.style.display = 'none';
    d.style.width   = (5 - i * 0.8) + 'px';
    d.style.height  = (9 + i * 5) + 'px';
    d.style.background = `rgba(140,220,210,${0.75 - i * 0.18})`;
    d.style.animationDuration    = (0.65 + i * 0.3) + 's';
    d.style.animationDelay       = (i * 0.2) + 's';
    dripsEl.appendChild(d);
    drips.push(d);
  }

  /* ─── Apply can transform ──────────────────────────────── */
  function applyCan(x, y, rot, scale, opacity) {
    canWrapper.style.left    = (x - CAN_W / 2) + 'px';
    canWrapper.style.top     = (y - CAN_H / 2) + 'px';
    canWrapper.style.opacity = opacity;
    canWrapper.style.transform = `rotate(${rot}deg) scale(${scale})`;

    const tealOpacity = 0.45 * (canWrapper._fillLevel || 1);
    canWrapper.style.filter =
      `drop-shadow(0 18px 44px rgba(0,196,184,${tealOpacity})) drop-shadow(0 4px 14px rgba(0,0,0,0.85))`;
  }

  /* ─── Update liquid fill ───────────────────────────────── */
  function updateFill(fillLevel) {
    canWrapper._fillLevel = fillLevel;
    canWrapper.innerHTML = buildCanSVG(fillLevel);
  }

  /* ─── Trail ────────────────────────────────────────────── */
  function updateTrail(x, y, ts) {
    trailHistory.push({ x, y, ts });
    if (trailHistory.length > TRAIL_COUNT) trailHistory.shift();

    trailDots.forEach((dot, i) => {
      if (i >= trailHistory.length) { dot.style.display = 'none'; return; }
      const pt  = trailHistory[i];
      const age = (i + 1) / trailHistory.length;
      const sz  = 5 + age * 16;
      dot.style.display  = 'block';
      dot.style.width    = sz + 'px';
      dot.style.height   = sz + 'px';
      dot.style.left     = (pt.x - sz/2) + 'px';
      dot.style.top      = (pt.y - sz/2) + 'px';
      dot.style.background = `rgba(0,196,184,${age * 0.35})`;
      dot.style.filter   = `blur(${Math.max(0, 4 - age * 3)}px)`;
    });
  }

  function clearTrail() {
    trailHistory = [];
    trailDots.forEach(d => d.style.display = 'none');
  }

  /* ─── Drips ─────────────────────────────────────────────── */
  function showDrips(canX, canY) {
    drips.forEach((d, i) => {
      d.style.display = 'block';
      d.style.left    = (canX + CAN_W * 0.28 + i * 14) + 'px';
      d.style.top     = (canY + CAN_H * 0.44) + 'px';
    });
  }
  function hideDrips() {
    drips.forEach(d => d.style.display = 'none');
  }

  /* ─── Position helpers ──────────────────────────────────── */
  function getStart() { return { x: -100, y: -120 }; }
  function getEnd() {
    const w = window.innerWidth;
    const h = window.innerHeight;
    return { x: w * 0.68, y: h * 0.5 };
  }

  /* ─── Animation loop ─────────────────────────────────────── */
  const FLY_DUR    = 2200;
  const SWIRL_DUR  = 850;
  const SETTLE_DUR = 500;
  const DRAIN_DUR  = 5800;
  const PAUSE_DUR  = 1600;
  const FADE_DUR   = 750;
  const GAP_DUR    = 1000;

  let phase      = 'flying';
  let phaseStart = null;
  let restartAt  = null;
  let currentX   = -100;
  let currentY   = -120;

  function reset(ts) {
    phase = 'flying'; phaseStart = ts;
    clearTrail(); hideDrips();
    allGoneEl.style.opacity = '0';
    updateFill(1);
    const s = getStart();
    currentX = s.x; currentY = s.y;
    applyCan(s.x, s.y, 0, 0.7, 0);
  }

  function tick(ts) {
    if (restartAt) {
      if (ts < restartAt) { requestAnimationFrame(tick); return; }
      restartAt = null;
      reset(ts);
    }

    if (!phaseStart) phaseStart = ts;
    const el  = ts - phaseStart;

    const start = getStart();
    const end   = getEnd();

    if (phase === 'flying') {
      const t  = Math.min(el / FLY_DUR, 1);
      const et = easeOutCubic(t);

      // Quadratic bezier control point — arc swoops down through centre
      const cx = window.innerWidth  * 0.35;
      const cy = window.innerHeight * 0.80;

      const bx = (1-et)*(1-et)*start.x + 2*(1-et)*et*cx + et*et*end.x;
      const by = (1-et)*(1-et)*start.y + 2*(1-et)*et*cy + et*et*end.y;

      // 3 full spins (1080°) decelerating
      const spin  = 1080 * easeOutCubic(t);
      const sc    = lerp(0.65, 1, easeOutCubic(t));
      const alpha = clamp(el / 260, 0, 1);

      currentX = bx; currentY = by;
      applyCan(bx, by, spin, sc, alpha);

      if (t > 0.05 && t < 0.88) {
        updateTrail(bx, by, ts);
      } else if (t >= 0.88) {
        clearTrail();
      }

      if (t >= 1) { phase = 'swirl'; phaseStart = ts; }

    } else if (phase === 'swirl') {
      const t  = Math.min(el / SWIRL_DUR, 1);
      const wobble = Math.sin((1-t) * Math.PI * 3) * (1-t) * 28;
      applyCan(end.x, end.y, wobble, 1, 1);
      clearTrail();
      if (t >= 1) { phase = 'settle'; phaseStart = ts; }

    } else if (phase === 'settle') {
      const t      = Math.min(el / SETTLE_DUR, 1);
      const bounce = Math.sin(t * Math.PI * 2.5) * (1-t) * 7;
      applyCan(end.x, end.y, bounce, 1, 1);
      if (t >= 1) {
        applyCan(end.x, end.y, 0, 1, 1);
        phase = 'draining'; phaseStart = ts;
        showDrips(end.x, end.y);
      }

    } else if (phase === 'draining') {
      const t  = Math.min(el / DRAIN_DUR, 1);
      const fill = 1 - easeInOutQuad(t);
      updateFill(fill);
      applyCan(end.x, end.y, 0, 1, 1);
      showDrips(end.x, end.y);

      if (t >= 1) {
        updateFill(0);
        hideDrips();
        allGoneEl.style.left    = end.x + 'px';
        allGoneEl.style.top     = (end.y + CAN_H * 0.57) + 'px';
        allGoneEl.style.opacity = '1';
        phase = 'pause'; phaseStart = ts;
      }

    } else if (phase === 'pause') {
      if (el >= PAUSE_DUR) { phase = 'fading'; phaseStart = ts; }

    } else if (phase === 'fading') {
      const t = Math.min(el / FADE_DUR, 1);
      canWrapper.style.opacity = String(1 - t);
      allGoneEl.style.opacity  = String(1 - t);
      canWrapper.style.transform = `rotate(0deg) scale(${1 - t * 0.12})`;
      if (t >= 1) { restartAt = ts + GAP_DUR; }
    }

    requestAnimationFrame(tick);
  }

  // Kick off
  requestAnimationFrame(tick);

})();
</script>
</body>
</html>
